import { __extends } from "tslib";
import { RecursiveAstVisitor } from '../angular';
import { compileToJSON } from '../util';
var ParseVisitorCompiler = /** @class */ (function (_super) {
    __extends(ParseVisitorCompiler, _super);
    function ParseVisitorCompiler() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ParseVisitorCompiler.prototype.visitBinary = function (ast) {
        var left = ast.left.visit(this);
        var right = ast.right.visit(this);
        return left + " " + ast.operation + " " + right;
    };
    // TODO
    ParseVisitorCompiler.prototype.visitChain = function (ast) {
        return compileToJSON(this.visitAll(ast.expressions));
    };
    ParseVisitorCompiler.prototype.visitConditional = function (ast) {
        var condition = ast.condition.visit(this);
        var trueExp = ast.trueExp.visit(this);
        var falseExp = ast.falseExp.visit(this);
        return condition + " ? " + trueExp + " : " + falseExp;
    };
    ParseVisitorCompiler.prototype.visitPipe = function (ast) {
        var pipe = ast.name;
        var args = this.visitAll(ast.args);
        var value = ast.exp.visit(this);
        args.unshift(value);
        return "pipesCache.get('" + pipe + "').transform.apply(null, " + compileToJSON(args) + ")";
    };
    // TODO
    ParseVisitorCompiler.prototype.visitFunctionCall = function (ast) {
        var target = ast.target.visit(this);
        var args = compileToJSON(this.visitAll(ast.args));
        return target + ".apply(" + target + ", " + args + ")";
    };
    ParseVisitorCompiler.prototype.visitImplicitReceiver = function (ast) {
        return "context";
    };
    ParseVisitorCompiler.prototype.visitInterpolation = function (ast) {
        return this.visitAll(ast.expressions)[0];
    };
    ParseVisitorCompiler.prototype.visitKeyedRead = function (ast) {
        var obj = ast.obj.visit(this);
        var key = ast.key.visit(this);
        return obj + "[" + key + "]";
    };
    ParseVisitorCompiler.prototype.visitKeyedWrite = function (ast) {
        return null;
    };
    ParseVisitorCompiler.prototype.visitLiteralArray = function (ast) {
        return compileToJSON(this.visitAll(ast.expressions));
    };
    ParseVisitorCompiler.prototype.visitLiteralMap = function (ast) {
        var result = {};
        var keys = ast.keys;
        var values = this.visitAll(ast.values);
        for (var i = 0, length_1 = keys.length; i < length_1; i++) {
            result[keys[i]] = values[i];
        }
        return compileToJSON(result);
    };
    ParseVisitorCompiler.prototype.visitLiteralPrimitive = function (ast) {
        return typeof ast.value === 'string' ? "'" + ast.value + "'" : ast.value;
    };
    ParseVisitorCompiler.prototype.visitMethodCall = function (ast) {
        var methodName = ast.name;
        var receiver = ast.receiver.visit(this);
        var args = compileToJSON(this.visitAll(ast.args));
        return receiver + "['" + methodName + "'].apply(" + receiver + ", " + args + ")";
    };
    ParseVisitorCompiler.prototype.visitPrefixNot = function (ast) {
        return ast.expression.visit(this);
    };
    ParseVisitorCompiler.prototype.visitPropertyRead = function (ast) {
        var property = ast.name;
        var receiver = ast.receiver.visit(this);
        return receiver + "['" + property + "']";
    };
    ParseVisitorCompiler.prototype.visitPropertyWrite = function (ast) {
        return null;
    };
    ParseVisitorCompiler.prototype.visitSafePropertyRead = function (ast) {
        var property = ast.name;
        var receiver = ast.receiver.visit(this);
        return receiver + "['" + property + "']";
    };
    ParseVisitorCompiler.prototype.visitSafeMethodCall = function (ast) {
        var methodName = ast.name;
        var receiver = ast.receiver.visit(this);
        var args = compileToJSON(this.visitAll(ast.args));
        return receiver + "['" + methodName + "'].apply(" + receiver + ", " + args + ")";
    };
    ParseVisitorCompiler.prototype.visitAll = function (asts) {
        var _this = this;
        return asts.map(function (ast) { return ast.visit(_this); });
    };
    ParseVisitorCompiler.prototype.visitQuote = function (ast) {
        return null;
    };
    return ParseVisitorCompiler;
}(RecursiveAstVisitor));
export { ParseVisitorCompiler };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyc2UtdmlzaXRvci1jb21waWxlci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2FuZ3VsYXIycGFyc2UvIiwic291cmNlcyI6WyJsaWIvdmlzaXRvcnMvcGFyc2UtdmlzaXRvci1jb21waWxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUVILG1CQUFtQixFQW9CdEIsTUFBTSxZQUFZLENBQUM7QUFDcEIsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUV4QztJQUEwQyx3Q0FBbUI7SUFBN0Q7O0lBMkhBLENBQUM7SUF6SEcsMENBQVcsR0FBWCxVQUFZLEdBQVc7UUFDbkIsSUFBTSxJQUFJLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbEMsSUFBTSxLQUFLLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFcEMsT0FBVSxJQUFJLFNBQUksR0FBRyxDQUFDLFNBQVMsU0FBSSxLQUFPLENBQUM7SUFDL0MsQ0FBQztJQUVELE9BQU87SUFDUCx5Q0FBVSxHQUFWLFVBQVcsR0FBVTtRQUNqQixPQUFPLGFBQWEsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO0lBQ3pELENBQUM7SUFFRCwrQ0FBZ0IsR0FBaEIsVUFBaUIsR0FBZ0I7UUFDN0IsSUFBTSxTQUFTLEdBQUcsR0FBRyxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDNUMsSUFBTSxPQUFPLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDeEMsSUFBTSxRQUFRLEdBQUcsR0FBRyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFMUMsT0FBVSxTQUFTLFdBQU0sT0FBTyxXQUFNLFFBQVUsQ0FBQztJQUNyRCxDQUFD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QVUsaUJBQVksUUFBUSxVQUFLLElBQUksTUFBRyxDQUFDO0lBQ3RFLENBQUM7SUFFRCx1Q0FBUSxHQUFSLFVBQVMsSUFBVztRQUFwQixpQkFFQztRQURHLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFBLEdBQUcsSUFBSSxPQUFBLEdBQUcsQ0FBQyxLQUFLLENBQUMsS0FBSSxDQUFDLEVBQWYsQ0FBZSxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUVELHlDQUFVLEdBQVYsVUFBVyxHQUFVO1FBQ2pCLE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFDTCwyQkFBQztBQUFELENBQUMsQUEzSEQsQ0FBMEMsbUJBQW1CLEdBMkg1RCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gICAgQVNULFxuICAgIFJlY3Vyc2l2ZUFzdFZpc2l0b3IsXG4gICAgUHJvcGVydHlSZWFkLFxuICAgIE1ldGhvZENhbGwsXG4gICAgS2V5ZWRSZWFkLFxuICAgIEltcGxpY2l0UmVjZWl2ZXIsXG4gICAgTGl0ZXJhbFByaW1pdGl2ZSxcbiAgICBCaW5hcnksXG4gICAgQ2hhaW4sXG4gICAgQ29uZGl0aW9uYWwsXG4gICAgQmluZGluZ1BpcGUsXG4gICAgRnVuY3Rpb25DYWxsLFxuICAgIEludGVycG9sYXRpb24sXG4gICAgS2V5ZWRXcml0ZSxcbiAgICBMaXRlcmFsQXJyYXksXG4gICAgTGl0ZXJhbE1hcCxcbiAgICBQcmVmaXhOb3QsXG4gICAgUHJvcGVydHlXcml0ZSxcbiAgICBTYWZlUHJvcGVydHlSZWFkLFxuICAgIFNhZmVNZXRob2RDYWxsLFxuICAgIFF1b3RlXG59IGZyb20gJy4uL2FuZ3VsYXInO1xuaW1wb3J0IHsgY29tcGlsZVRvSlNPTiB9IGZyb20gJy4uL3V0aWwnO1xuXG5leHBvcnQgY2xhc3MgUGFyc2VWaXNpdG9yQ29tcGlsZXIgZXh0ZW5kcyBSZWN1cnNpdmVBc3RWaXNpdG9yIHtcblxuICAgIHZpc2l0QmluYXJ5KGFzdDogQmluYXJ5KTogYW55IHtcbiAgICAgICAgY29uc3QgbGVmdCA9IGFzdC5sZWZ0LnZpc2l0KHRoaXMpO1xuICAgICAgICBjb25zdCByaWdodCA9IGFzdC5yaWdodC52aXNpdCh0aGlzKTtcblxuICAgICAgICByZXR1cm4gYCR7bGVmdH0gJHthc3Qub3BlcmF0aW9ufSAke3JpZ2h0fWA7XG4gICAgfVxuXG4gICAgLy8gVE9ET1xuICAgIHZpc2l0Q2hhaW4oYXN0OiBDaGFpbik6IGFueSB7XG4gICAgICAgIHJldHVybiBjb21waWxlVG9KU09OKHRoaXMudmlzaXRBbGwoYXN0LmV4cHJlc3Npb25zKSk7XG4gICAgfVxuXG4gICAgdmlzaXRDb25kaXRpb25hbChhc3Q6IENvbmRpdGlvbmFsKTogYW55IHtcbiAgICAgICAgY29uc3QgY29uZGl0aW9uID0gYXN0LmNvbmRpdGlvbi52aXNpdCh0aGlzKTtcbiAgICAgICAgY29uc3QgdHJ1ZUV4cCA9IGFzdC50cnVlRXhwLnZpc2l0KHRoaXMpO1xuICAgICAgICBjb25zdCBmYWxzZUV4cCA9IGFzdC5mYWxzZUV4cC52aXNpdCh0aGlzKTtcblxuICAgICAgICByZXR1cm4gYCR7Y29uZGl0aW9ufSA/ICR7dHJ1ZUV4cH0gOiAke2ZhbHNlRXhwfWA7XG4gICAgfVxuXG4gICAgdmlzaXRQaXBlKGFzdDogQmluZGluZ1BpcGUpOiBhbnkge1xuICAgICAgICBjb25zdCBwaXBlID0gYXN0Lm5hbWU7XG4gICAgICAgIGNvbnN0IGFyZ3MgPSB0aGlzLnZpc2l0QWxsKGFzdC5hcmdzKTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBhc3QuZXhwLnZpc2l0KHRoaXMpO1xuICAgICAgICBhcmdzLnVuc2hpZnQodmFsdWUpO1xuXG4gICAgICAgIHJldHVybiBgcGlwZXNDYWNoZS5nZXQoJyR7cGlwZX0nKS50cmFuc2Zvcm0uYXBwbHkobnVsbCwgJHtjb21waWxlVG9KU09OKGFyZ3MpfSlgO1xuICAgIH1cblxuICAgIC8vIFRPRE9cbiAgICB2aXNpdEZ1bmN0aW9uQ2FsbChhc3Q6IEZ1bmN0aW9uQ2FsbCk6IGFueSB7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGFzdC50YXJnZXQudmlzaXQodGhpcyk7XG4gICAgICAgIGNvbnN0IGFyZ3MgPSBjb21waWxlVG9KU09OKHRoaXMudmlzaXRBbGwoYXN0LmFyZ3MpKTtcblxuICAgICAgICByZXR1cm4gYCR7dGFyZ2V0fS5hcHBseSgke3RhcmdldH0sICR7YXJnc30pYDtcbiAgICB9XG5cbiAgICB2aXNpdEltcGxpY2l0UmVjZWl2ZXIoYXN0OiBJbXBsaWNpdFJlY2VpdmVyKTogYW55IHtcbiAgICAgICAgcmV0dXJuIGBjb250ZXh0YDtcbiAgICB9XG5cbiAgICB2aXNpdEludGVycG9sYXRpb24oYXN0OiBJbnRlcnBvbGF0aW9uKTogYW55IHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmlzaXRBbGwoYXN0LmV4cHJlc3Npb25zKVswXTtcbiAgICB9XG5cbiAgICB2aXNpdEtleWVkUmVhZChhc3Q6IEtleWVkUmVhZCk6IGFueSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IGFzdC5vYmoudmlzaXQodGhpcyk7XG4gICAgICAgIGNvbnN0IGtleSA9IGFzdC5rZXkudmlzaXQodGhpcyk7XG5cbiAgICAgICAgcmV0dXJuIGAke29ian1bJHtrZXl9XWA7XG4gICAgfVxuXG4gICAgdmlzaXRLZXllZFdyaXRlKGFzdDogS2V5ZWRXcml0ZSk6IGFueSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHZpc2l0TGl0ZXJhbEFycmF5KGFzdDogTGl0ZXJhbEFycmF5KTogYW55IHtcbiAgICAgICAgcmV0dXJuIGNvbXBpbGVUb0pTT04odGhpcy52aXNpdEFsbChhc3QuZXhwcmVzc2lvbnMpKTtcbiAgICB9XG5cbiAgICB2aXNpdExpdGVyYWxNYXAoYXN0OiBMaXRlcmFsTWFwKTogYW55IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge307XG4gICAgICAgIGNvbnN0IGtleXMgPSBhc3Qua2V5cztcbiAgICAgICAgY29uc3QgdmFsdWVzID0gdGhpcy52aXNpdEFsbChhc3QudmFsdWVzKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuZ3RoID0ga2V5cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgcmVzdWx0W2tleXNbaV1dID0gdmFsdWVzW2ldO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbXBpbGVUb0pTT04ocmVzdWx0KTtcbiAgICB9XG5cbiAgICB2aXNpdExpdGVyYWxQcmltaXRpdmUoYXN0OiBMaXRlcmFsUHJpbWl0aXZlKTogYW55IHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBhc3QudmFsdWUgPT09ICdzdHJpbmcnID8gYCcke2FzdC52YWx1ZX0nYCA6IGFzdC52YWx1ZTtcbiAgICB9XG5cbiAgICB2aXNpdE1ldGhvZENhbGwoYXN0OiBNZXRob2RDYWxsKTogYW55IHtcbiAgICAgICAgY29uc3QgbWV0aG9kTmFtZSA9IGFzdC5uYW1lO1xuICAgICAgICBjb25zdCByZWNlaXZlciA9IGFzdC5yZWNlaXZlci52aXNpdCh0aGlzKTtcbiAgICAgICAgY29uc3QgYXJncyA9IGNvbXBpbGVUb0pTT04odGhpcy52aXNpdEFsbChhc3QuYXJncykpO1xuXG4gICAgICAgIHJldHVybiBgJHtyZWNlaXZlcn1bJyR7bWV0aG9kTmFtZX0nXS5hcHBseSgke3JlY2VpdmVyfSwgJHthcmdzfSlgO1xuICAgIH1cblxuICAgIHZpc2l0UHJlZml4Tm90KGFzdDogUHJlZml4Tm90KTogYW55IHtcbiAgICAgICAgcmV0dXJuIGFzdC5leHByZXNzaW9uLnZpc2l0KHRoaXMpO1xuICAgIH1cblxuICAgIHZpc2l0UHJvcGVydHlSZWFkKGFzdDogUHJvcGVydHlSZWFkKTogYW55IHtcbiAgICAgICAgY29uc3QgcHJvcGVydHkgPSBhc3QubmFtZTtcbiAgICAgICAgY29uc3QgcmVjZWl2ZXIgPSBhc3QucmVjZWl2ZXIudmlzaXQodGhpcyk7XG5cbiAgICAgICAgcmV0dXJuIGAke3JlY2VpdmVyfVsnJHtwcm9wZXJ0eX0nXWA7XG4gICAgfVxuXG4gICAgdmlzaXRQcm9wZXJ0eVdyaXRlKGFzdDogUHJvcGVydHlXcml0ZSk6IGFueSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHZpc2l0U2FmZVByb3BlcnR5UmVhZChhc3Q6IFNhZmVQcm9wZXJ0eVJlYWQpOiBhbnkge1xuICAgICAgICBjb25zdCBwcm9wZXJ0eSA9IGFzdC5uYW1lO1xuICAgICAgICBjb25zdCByZWNlaXZlciA9IGFzdC5yZWNlaXZlci52aXNpdCh0aGlzKTtcblxuICAgICAgICByZXR1cm4gYCR7cmVjZWl2ZXJ9Wycke3Byb3BlcnR5fSddYDtcbiAgICB9XG5cbiAgICB2aXNpdFNhZmVNZXRob2RDYWxsKGFzdDogU2FmZU1ldGhvZENhbGwpOiBhbnkge1xuICAgICAgICBjb25zdCBtZXRob2ROYW1lID0gYXN0Lm5hbWU7XG4gICAgICAgIGNvbnN0IHJlY2VpdmVyID0gYXN0LnJlY2VpdmVyLnZpc2l0KHRoaXMpO1xuICAgICAgICBjb25zdCBhcmdzID0gY29tcGlsZVRvSlNPTih0aGlzLnZpc2l0QWxsKGFzdC5hcmdzKSk7XG5cbiAgICAgICAgcmV0dXJuIGAke3JlY2VpdmVyfVsnJHttZXRob2ROYW1lfSddLmFwcGx5KCR7cmVjZWl2ZXJ9LCAke2FyZ3N9KWA7XG4gICAgfVxuXG4gICAgdmlzaXRBbGwoYXN0czogQVNUW10pOiBhbnkge1xuICAgICAgICByZXR1cm4gYXN0cy5tYXAoYXN0ID0+IGFzdC52aXNpdCh0aGlzKSk7XG4gICAgfVxuXG4gICAgdmlzaXRRdW90ZShhc3Q6IFF1b3RlKTogYW55IHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufSJdfQ==