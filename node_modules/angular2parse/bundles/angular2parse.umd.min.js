!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core")):"function"==typeof define&&define.amd?define("angular2parse",["exports","@angular/core"],e):e((t=t||self).angular2parse={},t.ng.core)}(this,(function(t,e){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function r(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function n(t,e,i,r){var n,s=arguments.length,o=s<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(s<3?n(o):s>3?n(e,i,o):n(e,i))||o);return s>3&&o&&Object.defineProperty(e,i,o),o}function s(t,e){return function(i,r){e(i,r,t)}}function o(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var r,n,s=i.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return o}function a(t){return null!=t}function p(t){return null==t}Object.getPrototypeOf({});var u=function(){function t(){}return t.parseIntAutoRadix=function(t){var e=parseInt(t);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+t);return e},t.isNumeric=function(t){return!isNaN(t-parseFloat(t))},t}();function h(t){return t.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}
/**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
/**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
var c=function(t,e,i,r){this.input=e,this.errLocation=i,this.ctxLocation=r,this.message="Parser Error: "+t+" "+i+" ["+e+"] in "+r},l=function(t,e){this.start=t,this.end=e},v=function(){function t(t){this.span=t}return t.prototype.visit=function(t,e){return void 0===e&&(e=null),null},t.prototype.toString=function(){return"AST"},t}(),f=function(t){function e(e,i,r,n){var s=t.call(this,e)||this;return s.prefix=i,s.uninterpretedExpression=r,s.location=n,s}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitQuote(this,e)},e.prototype.toString=function(){return"Quote"},e}(v),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.visit=function(t,e){void 0===e&&(e=null)},e}(v),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitImplicitReceiver(this,e)},e}(v),x=function(t){function e(e,i){var r=t.call(this,e)||this;return r.expressions=i,r}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitChain(this,e)},e}(v),w=function(t){function e(e,i,r,n){var s=t.call(this,e)||this;return s.condition=i,s.trueExp=r,s.falseExp=n,s}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitConditional(this,e)},e}(v),g=function(t){function e(e,i,r){var n=t.call(this,e)||this;return n.receiver=i,n.name=r,n}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitPropertyRead(this,e)},e}(v),C=function(t){function e(e,i,r,n){var s=t.call(this,e)||this;return s.receiver=i,s.name=r,s.value=n,s}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitPropertyWrite(this,e)},e}(v),m=function(t){function e(e,i,r){var n=t.call(this,e)||this;return n.receiver=i,n.name=r,n}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitSafePropertyRead(this,e)},e}(v),k=function(t){function e(e,i,r){var n=t.call(this,e)||this;return n.obj=i,n.key=r,n}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitKeyedRead(this,e)},e}(v),P=function(t){function e(e,i,r,n){var s=t.call(this,e)||this;return s.obj=i,s.key=r,s.value=n,s}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitKeyedWrite(this,e)},e}(v),E=function(t){function e(e,i,r,n){var s=t.call(this,e)||this;return s.exp=i,s.name=r,s.args=n,s}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitPipe(this,e)},e}(v),A=function(t){function e(e,i){var r=t.call(this,e)||this;return r.value=i,r}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitLiteralPrimitive(this,e)},e}(v),O=function(t){function e(e,i){var r=t.call(this,e)||this;return r.expressions=i,r}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitLiteralArray(this,e)},e}(v),b=function(t){function e(e,i,r){var n=t.call(this,e)||this;return n.keys=i,n.values=r,n}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitLiteralMap(this,e)},e}(v),R=function(t){function e(e,i,r){var n=t.call(this,e)||this;return n.strings=i,n.expressions=r,n}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitInterpolation(this,e)},e}(v),I=function(t){function e(e,i,r,n){var s=t.call(this,e)||this;return s.operation=i,s.left=r,s.right=n,s}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitBinary(this,e)},e}(v),_=function(t){function e(e,i){var r=t.call(this,e)||this;return r.expression=i,r}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitPrefixNot(this,e)},e}(v),S=function(t){function e(e,i,r,n){var s=t.call(this,e)||this;return s.receiver=i,s.name=r,s.args=n,s}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitMethodCall(this,e)},e}(v),K=function(t){function e(e,i,r,n){var s=t.call(this,e)||this;return s.receiver=i,s.name=r,s.args=n,s}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitSafeMethodCall(this,e)},e}(v),M=function(t){function e(e,i,r){var n=t.call(this,e)||this;return n.target=i,n.args=r,n}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),t.visitFunctionCall(this,e)},e}(v),L=function(t){function e(e,i,r,n){var s=t.call(this,new l(0,p(i)?0:i.length))||this;return s.ast=e,s.source=i,s.location=r,s.errors=n,s}return r(e,t),e.prototype.visit=function(t,e){return void 0===e&&(e=null),this.ast.visit(t,e)},e.prototype.toString=function(){return this.source+" in "+this.location},e}(v),N=function(t,e,i,r,n){this.span=t,this.key=e,this.keyIsVar=i,this.name=r,this.expression=n},j=function(){function t(){}return t.prototype.visitBinary=function(t,e){return t.left.visit(this),t.right.visit(this),null},t.prototype.visitChain=function(t,e){return this.visitAll(t.expressions,e)},t.prototype.visitConditional=function(t,e){return t.condition.visit(this),t.trueExp.visit(this),t.falseExp.visit(this),null},t.prototype.visitPipe=function(t,e){return t.exp.visit(this),this.visitAll(t.args,e),null},t.prototype.visitFunctionCall=function(t,e){return t.target.visit(this),this.visitAll(t.args,e),null},t.prototype.visitImplicitReceiver=function(t,e){return null},t.prototype.visitInterpolation=function(t,e){return this.visitAll(t.expressions,e)},t.prototype.visitKeyedRead=function(t,e){return t.obj.visit(this),t.key.visit(this),null},t.prototype.visitKeyedWrite=function(t,e){return t.obj.visit(this),t.key.visit(this),t.value.visit(this),null},t.prototype.visitLiteralArray=function(t,e){return this.visitAll(t.expressions,e)},t.prototype.visitLiteralMap=function(t,e){return this.visitAll(t.values,e)},t.prototype.visitLiteralPrimitive=function(t,e){return null},t.prototype.visitMethodCall=function(t,e){return t.receiver.visit(this),this.visitAll(t.args,e)},t.prototype.visitPrefixNot=function(t,e){return t.expression.visit(this),null},t.prototype.visitPropertyRead=function(t,e){return t.receiver.visit(this),null},t.prototype.visitPropertyWrite=function(t,e){return t.receiver.visit(this),t.value.visit(this),null},t.prototype.visitSafePropertyRead=function(t,e){return t.receiver.visit(this),null},t.prototype.visitSafeMethodCall=function(t,e){return t.receiver.visit(this),this.visitAll(t.args,e)},t.prototype.visitAll=function(t,e){var i=this;return t.forEach((function(t){return t.visit(i,e)})),null},t.prototype.visitQuote=function(t,e){return null},t}();!function(){function t(){}t.prototype.visitImplicitReceiver=function(t,e){return t},t.prototype.visitInterpolation=function(t,e){return new R(t.span,t.strings,this.visitAll(t.expressions))},t.prototype.visitLiteralPrimitive=function(t,e){return new A(t.span,t.value)},t.prototype.visitPropertyRead=function(t,e){return new g(t.span,t.receiver.visit(this),t.name)},t.prototype.visitPropertyWrite=function(t,e){return new C(t.span,t.receiver.visit(this),t.name,t.value)},t.prototype.visitSafePropertyRead=function(t,e){return new m(t.span,t.receiver.visit(this),t.name)},t.prototype.visitMethodCall=function(t,e){return new S(t.span,t.receiver.visit(this),t.name,this.visitAll(t.args))},t.prototype.visitSafeMethodCall=function(t,e){return new K(t.span,t.receiver.visit(this),t.name,this.visitAll(t.args))},t.prototype.visitFunctionCall=function(t,e){return new M(t.span,t.target.visit(this),this.visitAll(t.args))},t.prototype.visitLiteralArray=function(t,e){return new O(t.span,this.visitAll(t.expressions))},t.prototype.visitLiteralMap=function(t,e){return new b(t.span,t.keys,this.visitAll(t.values))},t.prototype.visitBinary=function(t,e){return new I(t.span,t.operation,t.left.visit(this),t.right.visit(this))},t.prototype.visitPrefixNot=function(t,e){return new _(t.span,t.expression.visit(this))},t.prototype.visitConditional=function(t,e){return new w(t.span,t.condition.visit(this),t.trueExp.visit(this),t.falseExp.visit(this))},t.prototype.visitPipe=function(t,e){return new E(t.span,t.exp.visit(this),t.name,this.visitAll(t.args))},t.prototype.visitKeyedRead=function(t,e){return new k(t.span,t.obj.visit(this),t.key.visit(this))},t.prototype.visitKeyedWrite=function(t,e){return new P(t.span,t.obj.visit(this),t.key.visit(this),t.value.visit(this))},t.prototype.visitAll=function(t){for(var e=new Array(t.length),i=0;i<t.length;++i)e[i]=t[i].visit(this);return e},t.prototype.visitChain=function(t,e){return new x(t.span,this.visitAll(t.expressions))},t.prototype.visitQuote=function(t,e){return new f(t.span,t.prefix,t.uninterpretedExpression,t.location)}}();function B(t){return 48<=t&&t<=57}
/**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
var T,V=new(function(){function t(t,e){this.start=t,this.end=e}return t.fromArray=function(e){return e?(function(t,e){if(a(e)&&(!Array.isArray(e)||2!=e.length))throw new Error("Expected '"+t+"' to be an array, [start, end].")}("interpolation",e),new t(e[0],e[1])):V},t}())("{{","}}");!function(t){t[t.Character=0]="Character",t[t.Identifier=1]="Identifier",t[t.Keyword=2]="Keyword",t[t.String=3]="String",t[t.Operator=4]="Operator",t[t.Number=5]="Number",t[t.Error=6]="Error"}(T||(T={}));var F=["var","let","null","undefined","true","false","if","else","this"],W=function(){function t(){}return t.prototype.tokenize=function(t){for(var e=new $(t),i=[],r=e.scanToken();null!=r;)i.push(r),r=e.scanToken();return i},t}(),Q=function(){function t(t,e,i,r){this.index=t,this.type=e,this.numValue=i,this.strValue=r}return t.prototype.isCharacter=function(t){return this.type==T.Character&&this.numValue==t},t.prototype.isNumber=function(){return this.type==T.Number},t.prototype.isString=function(){return this.type==T.String},t.prototype.isOperator=function(t){return this.type==T.Operator&&this.strValue==t},t.prototype.isIdentifier=function(){return this.type==T.Identifier},t.prototype.isKeyword=function(){return this.type==T.Keyword},t.prototype.isKeywordLet=function(){return this.type==T.Keyword&&"let"==this.strValue},t.prototype.isKeywordNull=function(){return this.type==T.Keyword&&"null"==this.strValue},t.prototype.isKeywordUndefined=function(){return this.type==T.Keyword&&"undefined"==this.strValue},t.prototype.isKeywordTrue=function(){return this.type==T.Keyword&&"true"==this.strValue},t.prototype.isKeywordFalse=function(){return this.type==T.Keyword&&"false"==this.strValue},t.prototype.isKeywordThis=function(){return this.type==T.Keyword&&"this"==this.strValue},t.prototype.isError=function(){return this.type==T.Error},t.prototype.toNumber=function(){return this.type==T.Number?this.numValue:-1},t.prototype.toString=function(){switch(this.type){case T.Character:case T.Identifier:case T.Keyword:case T.Operator:case T.String:case T.Error:return this.strValue;case T.Number:return this.numValue.toString();default:return null}},t}();function U(t,e){return new Q(t,T.Character,e,String.fromCharCode(e))}function q(t,e){return new Q(t,T.Operator,0,e)}var z=new Q(-1,T.Character,0,""),$=function(){function t(t){this.input=t,this.peek=0,this.index=-1,this.length=t.length,this.advance()}return t.prototype.advance=function(){this.peek=++this.index>=this.length?0:this.input.charCodeAt(this.index)},t.prototype.scanToken=function(){for(var t=this.input,e=this.length,i=this.peek,r=this.index;i<=32;){if(++r>=e){i=0;break}i=t.charCodeAt(r)}if(this.peek=i,this.index=r,r>=e)return null;if(G(i))return this.scanIdentifier();if(B(i))return this.scanNumber(r);var n,s=r;switch(i){case 46:return this.advance(),B(this.peek)?this.scanNumber(s):U(s,46);case 40:case 41:case 123:case 125:case 91:case 93:case 44:case 58:case 59:return this.scanCharacter(s,i);case 39:case 34:return this.scanString();case 35:case 43:case 45:case 42:case 47:case 37:case 94:return this.scanOperator(s,String.fromCharCode(i));case 63:return this.scanComplexOperator(s,"?",46,".");case 60:case 62:return this.scanComplexOperator(s,String.fromCharCode(i),61,"=");case 33:case 61:return this.scanComplexOperator(s,String.fromCharCode(i),61,"=",61,"=");case 38:return this.scanComplexOperator(s,"&",38,"&");case 124:return this.scanComplexOperator(s,"|",124,"|");case 160:for(;(n=this.peek)>=9&&n<=32||160==n;)this.advance();return this.scanToken()}return this.advance(),this.error("Unexpected character ["+String.fromCharCode(i)+"]",0)},t.prototype.scanCharacter=function(t,e){return this.advance(),U(t,e)},t.prototype.scanOperator=function(t,e){return this.advance(),q(t,e)},t.prototype.scanComplexOperator=function(t,e,i,r,n,s){this.advance();var o=e;return this.peek==i&&(this.advance(),o+=r),null!=n&&this.peek==n&&(this.advance(),o+=s),q(t,o)},t.prototype.scanIdentifier=function(){var t=this.index;for(this.advance();D(this.peek);)this.advance();var e,i=this.input.substring(t,this.index);return F.indexOf(i)>-1?(e=i,new Q(t,T.Keyword,0,e)):function(t,e){return new Q(t,T.Identifier,0,e)}(t,i)},t.prototype.scanNumber=function(t){var e,i=this.index===t;for(this.advance();;){if(B(this.peek));else if(46==this.peek)i=!1;else{if(101!=(e=this.peek)&&69!=e)break;if(this.advance(),H(this.peek)&&this.advance(),!B(this.peek))return this.error("Invalid exponent",-1);i=!1}this.advance()}var r,n=this.input.substring(t,this.index),s=i?u.parseIntAutoRadix(n):parseFloat(n);return r=s,new Q(t,T.Number,r,"")},t.prototype.scanString=function(){var t=this.index,e=this.peek;this.advance();for(var i="",r=this.index,n=this.input;this.peek!=e;)if(92==this.peek){i+=n.substring(r,this.index),this.advance();var s=void 0;if(this.peek=this.peek,117==this.peek){var o=n.substring(this.index+1,this.index+5);if(!/^[0-9a-f]+$/i.test(o))return this.error("Invalid unicode escape [\\u"+o+"]",0);s=parseInt(o,16);for(var a=0;a<5;a++)this.advance()}else s=J(this.peek),this.advance();i+=String.fromCharCode(s),r=this.index}else{if(0==this.peek)return this.error("Unterminated quote",0);this.advance()}var p,u=n.substring(r,this.index);return this.advance(),p=i+u,new Q(t,T.String,0,p)},t.prototype.error=function(t,e){var i=this.index+e;return function(t,e){return new Q(t,T.Error,0,e)}(i,"Lexer Error: "+t+" at column "+i+" in expression ["+this.input+"]")},t}();function G(t){return 97<=t&&t<=122||65<=t&&t<=90||95==t||36==t}function D(t){return function(t){return t>=97&&t<=122||t>=65&&t<=90}(t)||B(t)||95==t||36==t}function H(t){return 45==t||43==t}function J(t){switch(t){case 110:return 10;case 102:return 12;case 114:return 13;case 116:return 9;case 118:return 11;default:return t}}
/**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */var X=function(t,e,i){this.strings=t,this.expressions=e,this.offsets=i},Y=function(t,e,i){this.templateBindings=t,this.warnings=e,this.errors=i};function Z(t){var e=h(t.start)+"([\\s\\S]*?)"+h(t.end);return new RegExp(e,"g")}var tt=function(){function t(t){this._lexer=t,this.errors=[]}return t.prototype.parseAction=function(t,e,i){void 0===i&&(i=V),this._checkNoInterpolation(t,e,i);var r=this._stripComments(t),n=this._lexer.tokenize(this._stripComments(t)),s=new et(t,e,n,r.length,!0,this.errors,t.length-r.length).parseChain();return new L(s,t,e,this.errors)},t.prototype.parseBinding=function(t,e,i){void 0===i&&(i=V);var r=this._parseBindingAst(t,e,i);return new L(r,t,e,this.errors)},t.prototype.parseSimpleBinding=function(t,e,i){void 0===i&&(i=V);var r=this._parseBindingAst(t,e,i),n=it.check(r);return n.length>0&&this._reportError("Host binding expression cannot contain "+n.join(" "),t,e),new L(r,t,e,this.errors)},t.prototype._reportError=function(t,e,i,r){this.errors.push(new c(t,e,i,r))},t.prototype._parseBindingAst=function(t,e,i){var r=this._parseQuote(t,e);if(a(r))return r;this._checkNoInterpolation(t,e,i);var n=this._stripComments(t),s=this._lexer.tokenize(n);return new et(t,e,s,n.length,!1,this.errors,t.length-n.length).parseChain()},t.prototype._parseQuote=function(t,e){if(p(t))return null;var i=t.indexOf(":");if(-1==i)return null;var r=t.substring(0,i).trim();if(!function(t){if(0==t.length)return!1;var e=new $(t);if(!G(e.peek))return!1;for(e.advance();0!==e.peek;){if(!D(e.peek))return!1;e.advance()}return!0}(r))return null;var n=t.substring(i+1);return new f(new l(0,t.length),r,n,e)},t.prototype.parseTemplateBindings=function(t,e,i){var r=this._lexer.tokenize(e);if(t){var n=this._lexer.tokenize(t).map((function(t){return t.index=0,t}));r.unshift.apply(r,function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}(n))}return new et(e,i,r,e.length,!1,this.errors,0).parseTemplateBindings()},t.prototype.parseInterpolation=function(t,e,i){void 0===i&&(i=V);var r=this.splitInterpolation(t,e,i);if(null==r)return null;for(var n=[],s=0;s<r.expressions.length;++s){var o=r.expressions[s],a=this._stripComments(o),u=this._lexer.tokenize(this._stripComments(r.expressions[s])),h=new et(t,e,u,a.length,!1,this.errors,r.offsets[s]+(o.length-a.length)).parseChain();n.push(h)}return new L(new R(new l(0,p(t)?0:t.length),r.strings,n),t,e,this.errors)},t.prototype.splitInterpolation=function(t,e,i){void 0===i&&(i=V);var r=Z(i),n=t.split(r);if(n.length<=1)return null;for(var s=[],o=[],a=[],p=0,u=0;u<n.length;u++){var h=n[u];u%2==0?(s.push(h),p+=h.length):h.trim().length>0?(p+=i.start.length,o.push(h),a.push(p),p+=h.length+i.end.length):(this._reportError("Blank expressions are not allowed in interpolated strings",t,"at column "+this._findInterpolationErrorColumn(n,u,i)+" in",e),o.push("$implict"),a.push(p))}return new X(s,o,a)},t.prototype.wrapLiteralPrimitive=function(t,e){return new L(new A(new l(0,p(t)?0:t.length),t),t,e,this.errors)},t.prototype._stripComments=function(t){var e=this._commentStart(t);return a(e)?t.substring(0,e).trim():t},t.prototype._commentStart=function(t){for(var e,i=null,r=0;r<t.length-1;r++){var n=t.charCodeAt(r),s=t.charCodeAt(r+1);if(47===n&&47==s&&p(i))return r;i===n?i=null:p(i)&&(39===(e=n)||34===e||96===e)&&(i=n)}return null},t.prototype._checkNoInterpolation=function(t,e,i){var r=Z(i),n=t.split(r);n.length>1&&this._reportError("Got interpolation ("+i.start+i.end+") where expression was expected",t,"at column "+this._findInterpolationErrorColumn(n,1,i)+" in",e)},t.prototype._findInterpolationErrorColumn=function(t,e,i){for(var r="",n=0;n<e;n++)r+=n%2==0?t[n]:""+i.start+t[n]+i.end;return r.length},t}(),et=function(){function t(t,e,i,r,n,s,o){this.input=t,this.location=e,this.tokens=i,this.inputLength=r,this.parseAction=n,this.errors=s,this.offset=o,this.rparensExpected=0,this.rbracketsExpected=0,this.rbracesExpected=0,this.index=0}return t.prototype.peek=function(t){var e=this.index+t;return e<this.tokens.length?this.tokens[e]:z},Object.defineProperty(t.prototype,"next",{get:function(){return this.peek(0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputIndex",{get:function(){return this.index<this.tokens.length?this.next.index+this.offset:this.inputLength+this.offset},enumerable:!0,configurable:!0}),t.prototype.span=function(t){return new l(t,this.inputIndex)},t.prototype.advance=function(){this.index++},t.prototype.optionalCharacter=function(t){return!!this.next.isCharacter(t)&&(this.advance(),!0)},t.prototype.peekKeywordLet=function(){return this.next.isKeywordLet()},t.prototype.expectCharacter=function(t){this.optionalCharacter(t)||this.error("Missing expected "+String.fromCharCode(t))},t.prototype.optionalOperator=function(t){return!!this.next.isOperator(t)&&(this.advance(),!0)},t.prototype.expectOperator=function(t){this.optionalOperator(t)||this.error("Missing expected operator "+t)},t.prototype.expectIdentifierOrKeyword=function(){var t=this.next;return t.isIdentifier()||t.isKeyword()?(this.advance(),t.toString()):(this.error("Unexpected token "+t+", expected identifier or keyword"),"")},t.prototype.expectIdentifierOrKeywordOrString=function(){var t=this.next;return t.isIdentifier()||t.isKeyword()||t.isString()?(this.advance(),t.toString()):(this.error("Unexpected token "+t+", expected identifier, keyword, or string"),"")},t.prototype.parseChain=function(){for(var t=[],e=this.inputIndex;this.index<this.tokens.length;){var i=this.parsePipe();if(t.push(i),this.optionalCharacter(59))for(this.parseAction||this.error("Binding expression cannot contain chained expression");this.optionalCharacter(59););else this.index<this.tokens.length&&this.error("Unexpected token '"+this.next+"'")}return 0==t.length?new d(this.span(e)):1==t.length?t[0]:new x(this.span(e),t)},t.prototype.parsePipe=function(){var t=this.parseExpression();if(this.optionalOperator("|")){this.parseAction&&this.error("Cannot have a pipe in an action expression");do{for(var e=this.expectIdentifierOrKeyword(),i=[];this.optionalCharacter(58);)i.push(this.parseExpression());t=new E(this.span(t.span.start),t,e,i)}while(this.optionalOperator("|"))}return t},t.prototype.parseExpression=function(){return this.parseConditional()},t.prototype.parseConditional=function(){var t=this.inputIndex,e=this.parseLogicalOr();if(this.optionalOperator("?")){var i=this.parsePipe(),r=void 0;if(this.optionalCharacter(58))r=this.parsePipe();else{var n=this.inputIndex,s=this.input.substring(t,n);this.error("Conditional expression "+s+" requires all 3 expressions"),r=new d(this.span(t))}return new w(this.span(t),e,i,r)}return e},t.prototype.parseLogicalOr=function(){for(var t=this.parseLogicalAnd();this.optionalOperator("||");){var e=this.parseLogicalAnd();t=new I(this.span(t.span.start),"||",t,e)}return t},t.prototype.parseLogicalAnd=function(){for(var t=this.parseEquality();this.optionalOperator("&&");){var e=this.parseEquality();t=new I(this.span(t.span.start),"&&",t,e)}return t},t.prototype.parseEquality=function(){for(var t=this.parseRelational();this.next.type==T.Operator;){var e=this.next.strValue;switch(e){case"==":case"===":case"!=":case"!==":this.advance();var i=this.parseRelational();t=new I(this.span(t.span.start),e,t,i);continue}break}return t},t.prototype.parseRelational=function(){for(var t=this.parseAdditive();this.next.type==T.Operator;){var e=this.next.strValue;switch(e){case"<":case">":case"<=":case">=":this.advance();var i=this.parseAdditive();t=new I(this.span(t.span.start),e,t,i);continue}break}return t},t.prototype.parseAdditive=function(){for(var t=this.parseMultiplicative();this.next.type==T.Operator;){var e=this.next.strValue;switch(e){case"+":case"-":this.advance();var i=this.parseMultiplicative();t=new I(this.span(t.span.start),e,t,i);continue}break}return t},t.prototype.parseMultiplicative=function(){for(var t=this.parsePrefix();this.next.type==T.Operator;){var e=this.next.strValue;switch(e){case"*":case"%":case"/":this.advance();var i=this.parsePrefix();t=new I(this.span(t.span.start),e,t,i);continue}break}return t},t.prototype.parsePrefix=function(){if(this.next.type==T.Operator){var t=this.inputIndex,e=this.next.strValue,i=void 0;switch(e){case"+":return this.advance(),this.parsePrefix();case"-":return this.advance(),i=this.parsePrefix(),new I(this.span(t),e,new A(new l(t,t),0),i);case"!":return this.advance(),i=this.parsePrefix(),new _(this.span(t),i)}}return this.parseCallChain()},t.prototype.parseCallChain=function(){for(var t=this.parsePrimary();;)if(this.optionalCharacter(46))t=this.parseAccessMemberOrMethodCall(t,!1);else if(this.optionalOperator("?."))t=this.parseAccessMemberOrMethodCall(t,!0);else if(this.optionalCharacter(91)){this.rbracketsExpected++;var e=this.parsePipe();if(this.rbracketsExpected--,this.expectCharacter(93),this.optionalOperator("=")){var i=this.parseConditional();t=new P(this.span(t.span.start),t,e,i)}else t=new k(this.span(t.span.start),t,e)}else{if(!this.optionalCharacter(40))return t;this.rparensExpected++;var r=this.parseCallArguments();this.rparensExpected--,this.expectCharacter(41),t=new M(this.span(t.span.start),t,r)}},t.prototype.parsePrimary=function(){var t=this.inputIndex;if(this.optionalCharacter(40)){this.rparensExpected++;var e=this.parsePipe();return this.rparensExpected--,this.expectCharacter(41),e}if(this.next.isKeywordNull())return this.advance(),new A(this.span(t),null);if(this.next.isKeywordUndefined())return this.advance(),new A(this.span(t),void 0);if(this.next.isKeywordTrue())return this.advance(),new A(this.span(t),!0);if(this.next.isKeywordFalse())return this.advance(),new A(this.span(t),!1);if(this.next.isKeywordThis())return this.advance(),new y(this.span(t));if(this.optionalCharacter(91)){this.rbracketsExpected++;var i=this.parseExpressionList(93);return this.rbracketsExpected--,this.expectCharacter(93),new O(this.span(t),i)}if(this.next.isCharacter(123))return this.parseLiteralMap();if(this.next.isIdentifier())return this.parseAccessMemberOrMethodCall(new y(this.span(t)),!1);if(this.next.isNumber()){var r=this.next.toNumber();return this.advance(),new A(this.span(t),r)}if(this.next.isString()){var n=this.next.toString();return this.advance(),new A(this.span(t),n)}return this.index>=this.tokens.length?(this.error("Unexpected end of expression: "+this.input),new d(this.span(t))):(this.error("Unexpected token "+this.next),new d(this.span(t)))},t.prototype.parseExpressionList=function(t){var e=[];if(!this.next.isCharacter(t))do{e.push(this.parsePipe())}while(this.optionalCharacter(44));return e},t.prototype.parseLiteralMap=function(){var t=[],e=[],i=this.inputIndex;if(this.expectCharacter(123),!this.optionalCharacter(125)){this.rbracesExpected++;do{var r=this.expectIdentifierOrKeywordOrString();t.push(r),this.expectCharacter(58),e.push(this.parsePipe())}while(this.optionalCharacter(44));this.rbracesExpected--,this.expectCharacter(125)}return new b(this.span(i),t,e)},t.prototype.parseAccessMemberOrMethodCall=function(t,e){void 0===e&&(e=!1);var i=t.span.start,r=this.expectIdentifierOrKeyword();if(this.optionalCharacter(40)){this.rparensExpected++;var n=this.parseCallArguments();this.expectCharacter(41),this.rparensExpected--;var s=this.span(i);return e?new K(s,t,r,n):new S(s,t,r,n)}if(e)return this.optionalOperator("=")?(this.error("The '?.' operator cannot be used in the assignment"),new d(this.span(i))):new m(this.span(i),t,r);if(this.optionalOperator("=")){if(!this.parseAction)return this.error("Bindings cannot contain assignments"),new d(this.span(i));var o=this.parseConditional();return new C(this.span(i),t,r,o)}return new g(this.span(i),t,r)},t.prototype.parseCallArguments=function(){if(this.next.isCharacter(41))return[];var t=[];do{t.push(this.parsePipe())}while(this.optionalCharacter(44));return t},t.prototype.expectTemplateBindingKey=function(){var t="",e=!1;do{t+=this.expectIdentifierOrKeywordOrString(),(e=this.optionalOperator("-"))&&(t+="-")}while(e);return t.toString()},t.prototype.parseTemplateBindings=function(){for(var t=[],e=null;this.index<this.tokens.length;){var i=this.inputIndex,r=this.peekKeywordLet();r&&this.advance();var n=this.expectTemplateBindingKey();r||(null==e?e=n:n=e+n[0].toUpperCase()+n.substring(1)),this.optionalCharacter(58);var s=null,o=null;if(r)s=this.optionalOperator("=")?this.expectTemplateBindingKey():"$implicit";else if(this.next!==z&&!this.peekKeywordLet()){var a=this.inputIndex,p=this.parsePipe(),u=this.input.substring(a-this.offset,this.inputIndex-this.offset);o=new L(p,u,this.location,this.errors)}t.push(new N(this.span(i),n,r,s,o)),this.optionalCharacter(59)||this.optionalCharacter(44)}return new Y(t,[],this.errors)},t.prototype.error=function(t,e){void 0===e&&(e=null),this.errors.push(new c(t,this.input,this.locationText(e),this.location)),this.skip()},t.prototype.locationText=function(t){return void 0===t&&(t=null),p(t)&&(t=this.index),t<this.tokens.length?"at column "+(this.tokens[t].index+1)+" in":"at the end of the expression"},t.prototype.skip=function(){for(var t=this.next;this.index<this.tokens.length&&!t.isCharacter(59)&&(this.rparensExpected<=0||!t.isCharacter(41))&&(this.rbracesExpected<=0||!t.isCharacter(125))&&(this.rbracketsExpected<=0||!t.isCharacter(93));)this.next.isError()&&this.errors.push(new c(this.next.toString(),this.input,this.locationText(),this.location)),this.advance(),t=this.next},t}(),it=function(){function t(){this.errors=[]}return t.check=function(e){var i=new t;return e.visit(i),i.errors},t.prototype.visitImplicitReceiver=function(t,e){},t.prototype.visitInterpolation=function(t,e){},t.prototype.visitLiteralPrimitive=function(t,e){},t.prototype.visitPropertyRead=function(t,e){},t.prototype.visitPropertyWrite=function(t,e){},t.prototype.visitSafePropertyRead=function(t,e){},t.prototype.visitMethodCall=function(t,e){},t.prototype.visitSafeMethodCall=function(t,e){},t.prototype.visitFunctionCall=function(t,e){},t.prototype.visitLiteralArray=function(t,e){this.visitAll(t.expressions)},t.prototype.visitLiteralMap=function(t,e){this.visitAll(t.values)},t.prototype.visitBinary=function(t,e){},t.prototype.visitPrefixNot=function(t,e){},t.prototype.visitConditional=function(t,e){},t.prototype.visitPipe=function(t,e){this.errors.push("pipes")},t.prototype.visitKeyedRead=function(t,e){},t.prototype.visitKeyedWrite=function(t,e){},t.prototype.visitAll=function(t){var e=this;return t.map((function(t){return t.visit(e)}))},t.prototype.visitChain=function(t,e){},t.prototype.visitQuote=function(t,e){},t}(),rt=new Map([["==",function(t,e){return t==e}],["===",function(t,e){return t===e}],["!=",function(t,e){return t!=e}],["!==",function(t,e){return t!==e}],["&&",function(t,e){return t&&e}],["||",function(t,e){return t||e}],["+",function(t,e){return t+e}],["-",function(t,e){return t-e}],["/",function(t,e){return t/e}],["*",function(t,e){return t*e}],["%",function(t,e){return t%e}],["<",function(t,e){return t<e}],["<=",function(t,e){return t<=e}],[">",function(t,e){return t>e}],[">=",function(t,e){return t>=e}]]);function nt(t){return JSON.stringify(t).replace(/"/g,"")}function st(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function ot(t){return"function"==typeof t}var at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.visitBinary=function(t){var e=t.left.visit(this),i=t.right.visit(this);return e+" "+t.operation+" "+i},e.prototype.visitChain=function(t){return nt(this.visitAll(t.expressions))},e.prototype.visitConditional=function(t){return t.condition.visit(this)+" ? "+t.trueExp.visit(this)+" : "+t.falseExp.visit(this)},e.prototype.visitPipe=function(t){var e=t.name,i=this.visitAll(t.args),r=t.exp.visit(this);return i.unshift(r),"pipesCache.get('"+e+"').transform.apply(null, "+nt(i)+")"},e.prototype.visitFunctionCall=function(t){var e=t.target.visit(this);return e+".apply("+e+", "+nt(this.visitAll(t.args))+")"},e.prototype.visitImplicitReceiver=function(t){return"context"},e.prototype.visitInterpolation=function(t){return this.visitAll(t.expressions)[0]},e.prototype.visitKeyedRead=function(t){return t.obj.visit(this)+"["+t.key.visit(this)+"]"},e.prototype.visitKeyedWrite=function(t){return null},e.prototype.visitLiteralArray=function(t){return nt(this.visitAll(t.expressions))},e.prototype.visitLiteralMap=function(t){for(var e={},i=t.keys,r=this.visitAll(t.values),n=0,s=i.length;n<s;n++)e[i[n]]=r[n];return nt(e)},e.prototype.visitLiteralPrimitive=function(t){return"string"==typeof t.value?"'"+t.value+"'":t.value},e.prototype.visitMethodCall=function(t){var e=t.name,i=t.receiver.visit(this);return i+"['"+e+"'].apply("+i+", "+nt(this.visitAll(t.args))+")"},e.prototype.visitPrefixNot=function(t){return t.expression.visit(this)},e.prototype.visitPropertyRead=function(t){var e=t.name;return t.receiver.visit(this)+"['"+e+"']"},e.prototype.visitPropertyWrite=function(t){return null},e.prototype.visitSafePropertyRead=function(t){var e=t.name;return t.receiver.visit(this)+"['"+e+"']"},e.prototype.visitSafeMethodCall=function(t){var e=t.name,i=t.receiver.visit(this);return i+"['"+e+"'].apply("+i+", "+nt(this.visitAll(t.args))+")"},e.prototype.visitAll=function(t){var e=this;return t.map((function(t){return t.visit(e)}))},e.prototype.visitQuote=function(t){return null},e}(j),pt=function(t){function e(e){var i=t.call(this)||this;return i.pipes=e,i}return r(e,t),e.prototype.visitBinary=function(t,e){var i=rt.get(t.operation);if(!i)throw new Error("Parse ERROR: on visitBinary, unknown operator "+t.operation);return i(t.left.visit(this,e),t.right.visit(this,e))},e.prototype.visitChain=function(t,e){return this.visitAll(t.expressions,e)},e.prototype.visitConditional=function(t,e){return t.condition.visit(this,e)?t.trueExp.visit(this,e):null!=t.falseExp?t.falseExp.visit(this,e):null},e.prototype.visitPipe=function(t,e){var i=this.pipes.get(t.name);if(!i)throw new Error("pipe "+t.name+" not found.");if(!i.transform)throw new Error("Parse ERROR: on visitPipe, transform method doesn't exist on pipe "+t.name+".");var r=t.exp.visit(this,e),n=this.visitAll(t.args,e);return n.unshift(r),i.transform.apply(null,n)},e.prototype.visitFunctionCall=function(t,e){var i=t.target.visit(this,e);if(!ot(i))throw new Error("Parse ERROR: on visitFunctionCall, target is not a function.");var r=this.visitAll(t.args,e);return i.apply(i,r)},e.prototype.visitImplicitReceiver=function(t,e){return e},e.prototype.visitInterpolation=function(t,e){return this.visitAll(t.expressions,e)[0]},e.prototype.visitKeyedRead=function(t,e){return t.obj.visit(this,e)[t.key.visit(this,e)]},e.prototype.visitKeyedWrite=function(t,e){var i=t.obj.visit(this,e),r=t.key.visit(this,e),n=t.value.visit(this,e);return i[r]=n,null},e.prototype.visitLiteralArray=function(t,e){return this.visitAll(t.expressions,e)},e.prototype.visitLiteralMap=function(t,e){for(var i={},r=t.keys,n=this.visitAll(t.values,e),s=0,o=r.length;s<o;s++)i[r[s]]=n[s];return i},e.prototype.visitLiteralPrimitive=function(t,e){return t.value},e.prototype.visitMethodCall=function(t,e){var i=t.receiver.visit(this,e);if(!st(i))throw new Error("Parse ERROR: on visitMethodCall, invalid method receiver.");var r=i[t.name];if(!ot(r))throw new Error("Parse ERROR: on visitMethodCall, method "+t.name+" doesn't exist on receiver.");var n=this.visitAll(t.args,e);return r.apply(i,n)},e.prototype.visitPrefixNot=function(t,e){return t.expression.visit(this,e)},e.prototype.visitPropertyRead=function(t,e){var i=t.receiver.visit(this,e);if(!st(i))throw new Error("Parse ERROR: on visitPropertyRead, invalid property receiver.");return i[t.name]},e.prototype.visitPropertyWrite=function(t,e){var i=t.receiver.visit(this,e);if(!st(i))throw new Error("Parse ERROR: on visitPropertyRead, invalid property receiver.");return i[t.name]=t.value.visit(this,e),null},e.prototype.visitSafePropertyRead=function(t,e){var i=t.receiver.visit(this,e);if(!st(i))throw new Error("Parse ERROR: on visitSafePropertyRead, invalid property receiver.");return i[t.name]},e.prototype.visitSafeMethodCall=function(t,e){var i=t.receiver.visit(this,e);if(!st(i))throw new Error("Parse ERROR: on visitSafeMethodCall, invalid method receiver.");var r=i[t.name];if(!ot(r))throw new Error("Parse ERROR: on visitSafeMethodCall, method "+t.name+" doesn't exist on receiver.");var n=this.visitAll(t.args,e);return r.apply(i,n)},e.prototype.visitAll=function(t,e){var i=this;return t.map((function(t){return t.visit(i,e)}))},e.prototype.visitQuote=function(t,e){throw new Error("Parse ERROR: on visitQuote, quote expression not allowed.")},e}(j),ut=new e.InjectionToken("PipesConfig"),ht=function(){function t(t){var e=this;this._parser=new tt(new W),this._pipesCache=new Map,this._evalCache=new Map,this._calcCache=new Map,t&&t.length&&t.filter((function(t){return t&&t.length})).forEach((function(t){return t.forEach((function(t){return e._pipesCache.set(t.pipeName,t.pipeInstance)}))}))}return t.prototype.eval=function(t){if(this._evalCache.has(t))return this._evalCache.get(t);var e=new at,i=this._parser.parseInterpolation(t,"Parse");i||(i=this._parser.parseBinding(t,"Parse"));var r=i.visit(e),n=this._pipesCache,s=new Function("context","pipesCache","return "+r+";"),o=function(t){return s(t,n)};return this._evalCache.set(t,o),o},t.prototype.calc=function(t){if(this._calcCache.has(t))return this._calcCache.get(t);var e=new pt(this._pipesCache),i=this._parser.parseInterpolation(t,"Parse");i||(i=this._parser.parseBinding(t,"Parse"));var r=function(t){return i.visit(e,t)};return this._calcCache.set(t,r),r},t.ctorParameters=function(){return[{type:Array,decorators:[{type:e.Optional},{type:e.Inject,args:[ut]}]}]},t.ɵprov=e["ɵɵdefineInjectable"]({factory:function(){return new t(e["ɵɵinject"](ut,8))},token:t,providedIn:"root"}),t=n([e.Injectable({providedIn:"root"}),s(0,e.Optional()),s(0,e.Inject(ut))],t)}(),ct=function(){function t(){}var i;return i=t,t.forRoot=function(t){return{ngModule:i,providers:[{provide:ut,multi:!0,useValue:t||[]}]}},t=i=n([e.NgModule()],t)}();t.Angular2ParseModule=ct,t.PIPES_CONFIG=ut,t.Parse=ht,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angular2parse.umd.min.js.map